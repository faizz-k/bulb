<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bulb</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="bulb-container">
        <div class="wire"></div>
        <div class="wire-connection"></div>
        <div class="socket-top"></div>
        <div class="socket-bottom"></div>
        <div class="socket-back"></div>
        <div class="bulb-top"></div>
        <div class="bulb-bottom"></div>
    </div>
    <div class="switch-container">
        <div class="switch-cover">
            <div class="switch-screw"></div>
            <div class="switch "></div>
            <div class="switch-screw"></div>
        </div>
    </div>
</body>
<script>
    let isOpen = false;
let btn = document.querySelector(".switch");
let bulbTop = document.querySelector(".bulb-top");
let bulbBottom = document.querySelector(".bulb-bottom");

// Function to toggle flashlight
async function toggleFlashlight(state) {
    try {
        const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } });
        const track = stream.getVideoTracks()[0];
        const capabilities = track.getCapabilities();

        if (capabilities.torch) {
            const constraints = { advanced: [{ torch: state }] };
            track.applyConstraints(constraints);
        } else {
            console.warn("Torch is not supported on this device.");
        }

        // Stop the track to avoid keeping the camera active
        if (!state) {
            track.stop();
        }
    } catch (error) {
        console.error("Error accessing the flashlight:", error);
    }
}

// Toggle bulb and flashlight
btn.addEventListener("click", function () {
    if (isOpen) {
        btn.classList.remove("on");
        bulbBottom.classList.remove("bulbOn");
        bulbTop.classList.remove("bulbOn");
        toggleFlashlight(false); // Turn off flashlight
    } else {
        btn.classList.add("on");
        bulbBottom.classList.add("bulbOn");
        bulbTop.classList.add("bulbOn");
        toggleFlashlight(true); // Turn on flashlight
    }
    isOpen = !isOpen;
});
</script>
</html>
